<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIC Examples</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; padding: 20px; }
    </style>
</head>
<body>

    <!-- npx live-server --port=5500 -->
    <div id="app">

        <label>
            First Name:
            <input type="text" kic-bind="kic.model.fname">
        </label>

        <label>
            Last Name:
            <input type="text" kic-bind="kic.model.lname">
        </label>

        <br />
        <br />

        <button onclick="handleShowHide()">Edit (Show/Hide)</button>
        <button onclick="handleAddCar()">Add (ForEach)</button>
        <button kic-click="sayHello(kic.model)">KIC Handler</button>

        <div kic-hide="kic.settings.edit">
            <h4>Cars</h4>
            <table>
                <thead>
                    <tr>
                        <td>Internal ID</td>
                        <td>Index</td>
                        <td>Brand</td>
                        <td>Serial</td>
                        <td>Action</td>
                    </tr>
                </thead>
                <tbody>
                    <tr kic-foreach="car in kic.model.cars">
                        <td>{{car.kicId}}</td>
                        <td>{{index}}</td>
                        <td>{{car.brand}}</td>
                        <td>{{car.serial}}</td>
                        <td><button kic-click="handleDeleteCar(event, car)">Delete</button></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div kic-show="kic.settings.edit">
            <h4>Cars</h4>
            <table>
                <thead>
                    <tr>
                        <td>Brand</td>
                        <td>Serial</td>
                        <td>Action</td>
                    </tr>
                </thead>
                <tbody>
                    <tr kic-foreach="car in kic.model.cars">
                        <td><input type="text" kic-bind="car.brand"></td>
                        <td><input type="text" kic-bind="car.serial"></td>
                        <td><button kic-click="handleDeleteCar(event, x)">Delete</button></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <br />
        <br />

        <p>{{ kic }}</p>
        <p>{{ kic.model.fname }}</p>
        <p>{{ kic.model.cars }}</p>
        <p>{{ kic.model.cars[1] }}</p>
        <p>{{ kic.model.cars[1].brand }}</p>
        <p>{{ kic.model.lname}}, {{ kic.model.cars[0].brand}} }} </p>

    </div>
       
    <script src="./src/kic.js"></script>
    <script>
        var dataset = { settings:{ edit:true }, model:{ fname: "Johnny", lname: "Andersson", cars:[{brand:"Volvo", serial:"v1234"}, {brand:"Ford", serial:"f2345"}]}, count:0};
        var appElement = document.getElementById("app");
        var kicapp = getKICApp(dataset, true);
        kicapp.enableConsoleLog(1, true);
        kicapp.addHandler("handleDeleteCar", function(event, data) 
        {
            var t = this.getData();
            // Find the index of the car with id 2
            const indexToRemove = t.model.cars.findIndex(car => car.kicId === data.kicId);

            // If the car is found, remove it using splice
            if (indexToRemove !== -1) {
                t.model.cars.splice(indexToRemove, 1);  // Remove the car at index found
            }

            t.count++;
            console.log("Clicked! Count:", this.count);
        });

        kicapp.addHandler("sayHello", function(event) 
        {
            alert('Hello !');
        });

        //Regular JS onClick Handler
        function handleShowHide()
        {
            var t = kicapp.getData();
            t.settings.edit = !t.settings.edit;
        }

        //Regular JS onClick Handler
        function handleAddCar()
        {
            var car = {brand:"Audi", serial:"v8888"};
            var t = kicapp.getData();
            t.model.cars.push(car);
        }

        kicapp.mount(appElement);


        

   
        
    </script>

</body>
</html>